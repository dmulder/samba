#!/usr/bin/env python
import os, sys
from subprocess import Popen

path = os.path.dirname(__file__)
waf_path = os.path.abspath(os.path.join(path, '../..', 'third_party/waf'))

if not os.path.exists(os.path.join(waf_path, '.git')):
    Popen(['git', 'submodule', 'update'], cwd=waf_path, env=os.environ).wait()

if not os.path.exists(os.path.join(waf_path, 'waf')):
    Popen(['./waf-light', 'configure', 'build'], cwd=waf_path).wait()

cmd = [os.path.join(waf_path, 'waf')]
cmd.extend(sys.argv[1:])
environ = os.environ
environ['WAFDIR'] = waf_path
sys.exit(Popen(cmd, env=environ).wait())

